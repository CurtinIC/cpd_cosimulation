function [Y,Xf,Af] = mytest(X,~,~)
%MYNEURALNETWORKFUNCTION n<1
% Generated by Neural Network Toolbox function genFunction, 07-Jul-2017 15:52:25.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx100 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.keep = [18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100];
x1_step2.xoffset = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001;0.0001];
x1_step2.gain = [20000;20000;10000;10000;6666.66666666667;6666.66666666667;5000;4000;3333.33333333333;2857.14285714286;2857.14285714286;2500;2222.22222222222;1818.18181818182;1666.66666666667;1428.57142857143;1428.57142857143;1333.33333333333;1250;1176.47058823529;1111.11111111111;1052.63157894737;1000;909.090909090909;869.565217391304;833.333333333333;769.230769230769;740.740740740741;689.655172413793;666.666666666667;625;588.235294117647;571.428571428571;555.555555555556;526.315789473684;500;476.190476190476;454.545454545455;444.444444444444;434.782608695652;425.531914893617;416.666666666667;400;392.156862745098;384.615384615385;370.37037037037;363.636363636364;357.142857142857;344.827586206897;338.983050847458;327.868852459016;322.58064516129;312.5;307.692307692308;298.507462686567;289.855072463768;285.714285714286;277.777777777778;270.27027027027;266.666666666667;259.74025974026;253.164556962025;246.913580246914;240.963855421687;235.294117647059;229.885057471264;224.719101123596;219.78021978022;215.05376344086;210.526315789474;206.185567010309;202.020202020202;196.078431372549;192.307692307692;188.679245283019;185.185185185185;181.818181818182;176.991150442478;173.913043478261;170.940170940171;166.666666666667;163.934426229508;161.290322580645];
x1_step2.ymin = -1;

% Layer 1
b1 = [1.3427233871961559153;1.0682979026857253313;-0.89491775879250334835;-0.12458361011521403017;-0.41396805410733550357;0.022165411872350528066;0.41603071561367893638;-0.71008923003657498096;1.2553279932838916633;1.353578845220414939];
IW1_1 = [0.0052999314776204379043 -0.24182086577732697652 -0.00017931951854008862986 0.050829869324139999309 -0.21939598004625471273 -0.29044860417794510221 0.22486704678590657691 0.098420129055166921672 0.045217607352836738932 0.10730031047945491618 0.20154715502790571113 -0.18795259959120003135 0.086962801904918160534 -0.046305353832117653046 -0.2364688405745555555 -0.096085699290240009218 -0.21495686444241254853 0.053250482307862015419 0.0010796538157164211388 0.05522900250385349985 0.24034918006974534399 -0.0068055430488878883646 -0.27014618886591529323 -0.039955230587740503401 -0.13634279972393167912 -0.23715219808202286922 -0.074550983352671226778 0.18678276847881042366 0.13004867308928860781 -0.17025551877259081923 -0.1661949041872005095 -0.10761049868157659959 0.19796690752539444769 -0.2658405762446914844 0.20711994578341030859 -0.19109326052540645535 -0.17708375178711216469 -0.21938369828077183832 -0.24206771685832564889 -0.042982685001221945797 0.097883767294368553835 -0.30305205680326990914 -0.27366724903818051562 0.22735709444711982297 0.05278987107210013352 -0.15465976855492444275 -0.30102239638520877918 0.15118007947991921047 0.18841019921151405669 0.03993300479938310249 -0.17775598525194449828 0.2150508298199373669 -0.13708181062380625503 -0.14667242328038726518 -0.26246750202521329509 -0.16091940162204945719 -0.062881285914037993168 -0.11280585697078836238 -0.0064199308409714963414 0.015190284809224966628 -0.082854079391777787911 -0.30763600901296472845 -0.22042548907082309961 -0.1354109167515918366 -0.29008849692841220946 0.045136975646846350108 0.1377658469778142436 0.18222857177062054546 -0.081506930691181977977 -0.044390438229295649253 -0.10977324504563379381 0.0390629631456072407 -0.060726930068054373046 -0.15982547046511688671 -0.0070252526553170810408 -0.050366050705475166882 0.13972748571417301089 -0.076220771971449122195 0.12283325424363057687 0.033340626148995626543 -0.17625922272616625919 -0.14951972365123822328 0.1839335648405120982;-0.22086834270652155876 -0.14891031035193019738 0.11320039562982661674 0.098882109486819524946 0.070924435132449836772 0.22672766501411290019 0.12936193536407838978 -0.22571731535013372927 -0.23228092269810904358 0.16076439152949753564 -0.095045560594594402648 -0.10525435377724105812 0.20683954796628922779 -0.089170432471899749305 -0.09953634331753363762 0.16203699074874663988 0.1375863373079525831 0.023292367991212412082 -0.2021012661012250855 -0.13556018295723890055 0.0069990646641688520138 0.19474997729346790742 0.2138408062414692834 -0.21675763151112262261 -0.16582163368960498029 0.22821050077980337134 -0.051953150085374627531 -0.081323192330340549061 -0.14235258263347888574 0.24444985332133709055 -0.1827170687680229888 0.1464917351981482041 0.16165510512490077755 -0.016687014679233384828 0.11185561432162129114 0.060835665666431490428 -0.23422268171098828415 0.03117197678784649692 0.23052845032105934164 -0.098169197659757193031 0.25688799071465689972 -0.0015326852261487019721 -0.22285391689225625411 0.27484070583744457661 0.16124781167159077389 0.24683633216018086021 -0.18773570669998468352 -0.24111059191234171517 -0.22061091827816367572 -0.24227103668457777852 0.18301015850093077519 0.21732690109233654407 0.042414177589848271743 0.042469394064590972049 0.029120386490764711696 -0.01155263874244526201 -0.11543282207135892314 0.11735540993944643118 0.09727997532647142398 -0.09986117933871742347 0.1200191090091073387 -0.059788589375608408583 0.0037182467186144432629 0.21813853774220196002 -0.18566434068659734558 -0.10311760425917866624 0.098124977408901664644 -0.15615078312574912078 0.15770112848018519314 -0.22856834795188538112 0.14854136232112749583 -0.17388582984492495509 0.0055996320654579587184 0.10841110362403659495 -0.064135095761655019908 -0.21092850427013534742 -0.071206782942201216069 -0.0013846041989341584255 0.1801800378340401021 -0.1625286126469133452 -0.21798337312306731439 -0.19583166510826355289 0.0037012114534166386942;0.076858920980482386964 0.22428893640546551658 -0.026141317703299235542 -0.021137450559079638823 0.093686655299408810871 -0.085460779612710244257 0.056856968145712699636 -0.17801389867451736237 0.064762341757563221534 0.25104591972783146803 0.10945594350371883052 0.25965916521464516009 -0.24016915160318377809 -0.19466410500097292013 0.076825574732153484314 0.14563807457614499907 0.1588564193627479415 0.10145711461730991254 -0.18957629905130332637 -0.1992879800292419179 -0.14848387181854211248 -0.055808137932836121564 -0.016548882033454968832 -0.14001484533623556605 -0.026465637635535568806 -0.035458511327756243869 -0.061570812689413847996 0.24260426291882250527 -0.043138707682756030626 0.23804618732797627745 0.073483016686618954361 0.26044077278174482259 -0.25687684279524453101 -0.088836880554942238009 -0.20712919823979997203 -0.16993591157842011241 -0.15527744263380094392 0.18092035631554079234 -0.21012788384787628448 0.2027792967558336712 0.17745814556269079443 -0.15475293622752811507 -0.23844337988354027957 -0.052650588957006284885 0.22160252074144468071 0.10840019888150605187 0.00022032597461201376254 -0.021577491497693494782 0.1659915256898964464 -0.12755208237967713414 -0.019859815512136537452 0.19149884507840359005 0.076848268684966594688 -0.077490720388399839114 0.20232085280771738844 -0.15729884352346584775 0.1474828633321103033 0.27190802073190073473 -0.098571459049713566758 0.18792128440760882957 -0.17768781759253371444 0.0040916478419906658973 0.20886274351496300627 -0.0019142178045594322733 -0.023727310114053892787 -0.11107933564566331575 0.066608423556702045509 0.0029348192563000462599 0.24013287642201330829 0.24156463236209435586 -0.024004527536960307277 0.17141658594914821467 -0.078850773787647182589 -0.15888325594791108397 -0.023133671076931448807 -0.014635121782591830816 -0.20998068242660558602 -0.092278065620630900234 -0.18990906896834575113 -0.21338442293745388256 0.032579740875325405303 0.26598333079479991037 0.19860529177111319044;-0.15952135324164545827 -0.20080489668848017226 0.18397644960767206568 -0.21943171935889718704 -0.052628718865705532981 0.39265364186914286648 0.25904824269577036988 0.14242031640683566751 0.0058584457567076647297 -0.051056638140185753305 0.10127605533028451179 0.033774793374275080549 0.13371572841472495474 -0.10554028365772119558 -0.058518835708647971849 -0.32537896958214157506 0.19951772870177636454 -0.17516994705646421471 -0.082411131264799750151 0.12251422180369223036 -0.12081889269729147174 -0.13738531855053445763 -0.010003712492740953616 0.22759995835165863776 0.11142487515943970411 -0.24387608927170012496 -0.10930190978828328852 0.19872985880572940909 -0.23399477473777294256 -0.1738230886722229307 0.12266263261729641598 -0.18144881063912693397 0.10933970511230907408 -0.19081050290079512588 0.20157445390337871971 -0.11200950391040237486 0.0047834798658167483609 -0.1705146376685789944 -0.24339692534376544675 0.009373688563179537539 -0.2971789153862395283 -0.17572048245853802428 0.23994553044170527367 -0.16941945818592857309 0.15736169060119464813 -0.081207902710894799836 0.045549899431118708037 -0.25435874993701707014 -0.18926885949357663552 0.21712788938451846321 0.026727776154248893137 0.13380566121541764835 0.24415834387457549526 0.19261187838019291907 -0.23868840540179533938 -0.18845428085412566088 -0.21970039036480848438 -0.21771885558906187152 0.057068399655250720559 -0.232908456479186593 0.097194905076821783152 0.07936174665500148051 0.1839140504163676304 0.19165189815659910977 -0.063743753396551278145 0.011815411927498757974 -0.0058074942048163043923 0.28159763558993000654 0.035126128225877947808 -0.14280013683777562083 -0.17364086603084993854 -0.11634927263920569196 -0.034839295794075235413 0.25989140851740960558 0.1812478243691525992 0.20852534907249220542 0.30926402894162702273 0.08353182005778311825 0.17887017267704682921 0.36355252650598052222 -0.074002424227370772192 0.064555964405751620205 0.0056907077318525418202;0.25235328616807684021 0.03089580290188780054 0.38263564924798143529 0.19904656655231683926 -0.072153740751880759974 -0.071578531372688838919 -0.13341401646908193634 -0.11315045036981763449 0.044947847683085392911 -0.23047208506882202461 -0.35164106085318236339 0.04861653001411395808 -0.3214977781927103595 0.012370593100387067623 -0.020504670264965177418 -0.23458912310507784582 0.22350003655299674477 -0.059772643450372919816 -0.058690136470504999933 -0.051227891473546324774 0.24309451764580281008 -0.19643273112577985806 0.074936833813168068907 0.085745654244641145159 0.069963166839513396544 0.052920665276230328955 -0.13204451774414610599 0.3194617515895364912 -0.039388554825632415834 0.34278885415032089856 0.15690335696869478488 0.32387466704139367124 0.16914924725486041313 0.076895654247657152514 -0.025014915811163863923 0.10442699906464396331 0.16653673525279608092 0.26164452111932240408 0.17737373003463011156 -0.15631020159448605344 0.33720380901676466623 -0.12111324288951330619 0.21508735782304819195 -0.10393525715505234908 0.035948150124489972046 0.27699779397018026161 -0.053764497178636024011 -0.042313824221990696539 0.18613802486873878839 0.026496109847331927173 -0.13163718472344601573 -0.13650771577259621092 -0.011230559620337639964 -0.028795774993431628302 -0.047277960639167164458 -0.090890178320667203149 -0.19976127865106796389 0.0094031502322427049784 -0.158067250980346935 -0.12973712567428899445 -0.13032141963796317619 -0.24269020971693888722 -0.19654047664473567325 -0.1727909537371102866 -0.22837270594479039398 0.075860730403277940037 -0.24465863714194377443 -0.16902667516153987992 -0.10627885031747863476 -0.19598339279635451637 0.1656589738545420909 -0.063244779244440718635 0.27523817384127247099 -0.20901158554752891083 -0.16045816623869979534 0.080202188837390039899 -0.060914083908600390183 -0.31159309389381550925 0.12276378273678478781 -0.19248652010351074981 -0.13094199574189088753 0.0052155023830417488254 -0.086697084216912967403;0.25414154930962157275 0.1544968904877936644 0.017061992181189766099 -0.13746004259486277466 -0.27570451073998225588 0.15091837447464528932 -0.014910789330281047985 -0.0053343586035843699664 -0.09415703410115540406 0.072063945878082305563 -0.081380867952992236303 -0.10089352959304644097 0.11468359676475976816 0.052280567987593923318 -0.039507650629264264019 -0.023529644107090529753 0.24998789141753996468 -0.14593031199863099046 -0.1115808258997965513 0.11288210331261266939 0.13850694496948096068 0.24097971568805950926 -0.075321541080630674547 0.11698799653135984189 -0.071337198500377965726 0.19958653786005339792 0.029710463124256403233 -0.17679498625161230163 0.24966191754185670937 -0.18861274622593754424 -0.00012923151289087869004 0.13048115935953585875 0.22396184276767655552 -0.15057512348258442203 0.19646643140796096749 0.0024673732339073129252 -0.052668992502375285014 -0.012229638093937615639 -0.057495883742863372612 -0.1181743046251888668 0.27186410633389040958 0.066962956254481148521 0.1579453844144107777 0.15697048620042472478 -0.068816592258221231937 0.11443168492156358118 -0.01311332165381423262 0.26765666138995325429 -0.13035172161925756562 -0.25569680628692653679 -0.17804702206731040648 -0.13091380696406226813 0.12188479757986764307 0.1240142399961427222 0.12957507213508989707 0.1607372326900826931 0.14315819352094921735 -0.21386430265690689612 0.10144635768075402349 0.25862906381724520832 0.20402826624782696707 -0.18683445836195994305 -0.22987391958714850637 -0.22385655995188560863 0.18646684349953351889 0.1793938933259099644 0.28492952526093168197 -0.018633123293900263201 -0.025351928229773071366 0.12635304067389563354 0.097354730475990830518 -0.14205583546775285564 -0.0067399671496945366342 0.25875004077537339109 -0.25750385433978600913 0.21497133902166645769 -0.18167933881449060962 -0.18088731807940092167 0.11611392612349821785 0.26955271162222638193 0.26521712397624724877 -0.13090925301354075505 0.055149913040733737624;0.15556166537009893935 0.058840418816771912491 -0.037147861856561659177 -0.11235773398234724652 -0.28528493829765833034 -0.32276700777004790899 0.3518970468376438343 -0.12381124452236363931 0.053419655855042907922 -0.19405230610798610003 0.2071375415435574574 -0.055677167759409181003 0.0052301160050694222442 -0.14482163775500347946 0.12066181891270509607 0.071737907948808840586 -0.1956166174073777908 -0.13770422211285954228 -0.19029822937893137169 0.13634006094293682487 0.086056543615410041603 0.090881372722834197209 0.041375749486549033562 -0.11462446667344738938 -0.13659516141178351667 -0.098559180102179275162 -0.30551128042760355985 -0.31890375187630043419 -0.3174135536751683806 0.12619122369499208292 0.24721593578990549989 -0.24375998961367362217 0.038109260970862070261 0.24643250408980513222 -0.020994667705138553293 0.19241314223225092217 0.085438831681421315012 0.03027674321512587724 -0.096244972924620253441 -0.17645241977573628001 0.077443744291000010671 0.097920885027083806595 -0.26683247704165902192 0.13577679690547378444 -0.24244618366856954261 0.065622822012364759314 -0.065123309938088916327 0.20923189390272264876 -0.16835056121422595221 -0.023951421430979485255 0.23712772152534089543 -0.037318642584097221071 -0.17024558474737200298 0.079642450949314297359 0.21692276017003117583 0.066375164588474422356 -0.089778601305595284732 0.12683019393916017403 0.10190748128877934187 0.081047253931986501518 0.18909779813277705074 0.077324084394722256142 0.097951821691792867464 -0.16592122888193738817 -0.068270133575635480461 0.025759782065058533379 0.087550291832440091389 0.063987186200692824922 -0.11740792341521782971 0.097718887517724395408 -0.043138693323458272844 -0.14141623005842154925 0.12841107881056718076 0.11238629201725174045 0.2434398777140583392 0.12945458725274594514 -0.30053219085385285414 -0.12465811023821926629 0.04806265544826483771 0.047896900851127667542 -0.12860924089358791167 0.20562614277149376951 0.21823937845977950389;-0.13512703428726072219 0.267223773711707413 0.089533866475896825565 0.14081111487698860785 0.10177718395017433528 0.036314974430277452422 0.081587625374221137142 0.21331111445041164854 -0.043763721785207612691 -0.091184625172086822276 -0.22785836586034194373 0.2182923199669354053 -0.23149807038968087114 0.078200954752361787059 -0.14400583130324606795 0.067584600890728485645 0.00068924224418612190998 0.02768904722308872246 0.20404004910391465577 -0.050920209040415415069 0.082496888629581585639 0.17166617875872208776 -0.10114067050892765198 -0.25717434346021428304 -0.23114343272143864083 0.14515113439469015666 0.031931931212169820111 -0.13637614332283534702 -0.197717497670796577 0.035728570615536969779 0.044795577225827672152 -0.12560075648106064361 0.071835311374487301195 0.22899739220027851005 0.038177096122388946842 0.25912153453089364907 0.21228232325186452423 0.25863005283034412596 0.16654536530204888667 0.043069414737749896205 0.24397916215586387678 -0.072347915496972003968 -0.18395593582542377198 -0.15767163768152925307 0.17706880880301636982 -0.019656148692023017038 -0.17581822053673362705 -0.15604547368574947508 -0.13341170882360933736 0.17865761430474522142 0.27210092947509528782 -0.22881990063787363554 -0.21376994759869488716 0.25695365009020876279 0.017325094251715512234 0.25363812212284747583 0.056274123174446473439 0.23181313989731305858 -0.0070631556959643900656 0.14184252528126578552 -0.0077298872541248786483 -0.13099475374610283773 0.0058228568211536498034 0.045086838807162799014 0.096055695120054726543 -0.23107895089100752295 -0.11953150551543552382 0.068156588510939170034 -0.098014628773179804377 -0.05526850661848789481 0.039018964672456975251 -0.23755555520790450075 0.10796526322232830042 -0.17034674873685501373 0.27664247991553364558 0.079346734390227560696 0.10266384354640728516 0.14987171059619711078 -0.21777685503771940234 -0.107013026178382889 0.25628725442070265927 -0.18142882770948520754 -0.16667778223445697816;0.066076380269444554005 -0.18155406385229819199 -0.14621194758577155115 -0.080216699720840986543 0.17218300492530166923 -0.088845134047674911848 -0.066447439564935276146 0.22233352798800076755 -0.048165726108821450835 0.18640082403402979949 -0.057963599651309614946 -0.18500534988888811538 0.14657527312107213047 -0.2407130898562660215 0.037603747556614205982 0.048969086888403616509 0.13089659983303067459 0.10278862704688365715 -0.0032579165390751434889 0.030722781184123901244 0.1220432073833953579 -0.08568679965756563488 -0.12103528890941309126 0.013570931613239101479 -0.20090764819422013421 0.098333801365974166098 -0.30074996014233490449 -0.13204652979139636093 -0.11772600344331959898 0.023336195923575924621 -0.17836737088693480069 0.21042829682039310146 -0.23384507664537590443 0.021529915010485012328 -0.03575798890417423298 0.23444428810514494899 -0.15048133829033338849 0.08287077520094431049 -0.11723739467814719983 -0.16420398281541304097 -0.092034616748202888181 -0.24883573196520067383 -0.13489858211774546914 -0.038517918427910233237 -0.20778789010901782541 0.25008140899363329179 0.24025619993118368933 0.017420039069892031408 0.26127589621529795361 0.20502178451478103582 -0.055701256242877042468 -0.12054878844073391164 0.074790171548798231593 -0.15439604943056689512 0.28418958760408008501 0.15767897568995140056 -0.10216969822933590073 -0.21922204099065559224 -0.18832168278090902214 0.1735032804833154807 -0.04796178498762358744 -0.20115749095585327977 0.011622534273282395315 0.11127884820109328057 0.047932491231073022508 0.17240907607640701404 -0.20353667858790877587 0.1083239916655084345 -0.17839933173101121811 -0.20117143400216286331 0.029595728597231436147 0.25498404342775105036 0.17671647383960240041 0.21061135763374153052 0.17096204625502398056 -0.10607163483383819091 -0.043216667978488609858 0.074161582297103151307 -0.14147702901703687606 0.034110544146312676839 -0.027182117697053389399 0.20131245172441458724 -0.22638059642217508993;0.085030929557159184995 0.12614148300383412615 0.21934919853702058989 0.24213524266801736418 -0.18262687632442914376 -0.12353208021411736517 0.20727884503990334775 -0.17291839828309224503 -0.19349826592172147954 0.012366609987386629685 -0.14138016153217580761 -0.2233665753297825185 0.22750369379277149418 0.22389002431043897312 0.24339630135238668474 -0.2412105570430671253 -0.02190884473044857686 -0.081666649088797588218 0.19489760611708484284 -0.18938689131775870989 0.02191580430884519301 0.067763864812835819529 0.081863126447030573618 -0.2273828296438290264 0.12795910530222770474 0.046782888963963209505 0.18796244702464171006 -0.14092563565823296168 0.1815809014200923388 0.0090251290580340287617 0.10383278208176817403 -0.0090600668711921239495 -0.14350225853303946733 -0.24811632338948835796 0.056107295860919385866 0.14804956934569082905 -0.10415646316834920038 0.25594377401166196195 0.059697699851984524499 0.0094555514167109101092 0.2356648103526221838 -0.20449822296042610703 0.22106309798805071076 -0.20786634761897099244 -0.23901918185818946117 0.18217246175147425169 -0.070231682068851039591 -0.095860296736584041377 -0.05108908060379042243 -0.092479411966543370593 0.17441684374953014824 0.25304242419926203933 0.10790223421567785023 0.061727593570655263366 -0.029280293879279002678 0.05411603468521445498 0.11978890420284808715 0.014477357394706126884 -0.032205775034577457938 -0.21748513731866769838 0.24936617152047002577 -0.23101590939777402745 -0.087527199625982710085 0.2401103727886260697 -0.25461259851756257166 -0.11325870069674344454 -0.13893897045754599606 -0.11779900344867155759 -0.17171073809083656214 -0.25558949439831307737 0.064190030956894461589 0.013754442322985069649 -0.12341536596329767683 0.22210353674309243899 0.25493071913758191815 -0.090056510263779976366 -0.07437938861927473333 0.098892665837238658 -0.094188628418689288035 0.10369510330968097211 -0.26714479073839414447 -0.048825647390373858037 -0.060466845190976087343];

% Layer 2
b2 = [0.7318013744249963759;-0.63232286206887500235;0.72219480142453373883];
LW2_1 = [0.16727329260819126522 0.050087538230416554785 -0.7863443209917406751 0.26240630370303308361 0.11999785953250792503 0.26191479495483971363 -0.36397047289633543965 0.49695123311240929631 -0.33707507825152044356 -0.64206937141240272293;0.60514028247322371179 0.44934821861693341472 -0.04593115739400242814 -0.83570554422106924086 0.73015389103628647316 0.68698806274256418725 0.073502450004528638305 -0.19663290085297260856 -0.54188366447278946136 0.621316658839028646;-0.47479360270475118311 -0.42582580676281417409 -0.8135948297527453299 -0.66500578605866977888 -0.45900947949600601206 0.4092639844187673237 -0.53808657724864616956 -0.7869861735351377785 -0.96166076114013354648 0.20799601033506737169];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [19.1915973539809;19.5049617638318;19.68495178569];
y1_step1.xoffset = [35.5657587754305;10.9177900072213;8.89489450097961];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    temp = removeconstantrows_apply(X{1,ts},x1_step1);
    Xp1 = mapminmax_apply(temp,x1_step2);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Remove Constants Input Processing Function
function y = removeconstantrows_apply(x,settings)
y = x(settings.keep,:);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
